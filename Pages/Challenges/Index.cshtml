@page
@model PCMSystem.Pages.Challenges.IndexModel

@{
    ViewData["Title"] = "S√†n ƒë·∫•u K√®o";
}

<div class="container mt-5">
    <h1 class="mb-4">üéæ S√†n ƒë·∫•u K√®o - V·ª£t Th·ªß Ph·ªë N√∫i</h1>

    <div class="mb-3">
        <a asp-page="./Create" class="btn btn-success btn-lg">
            ‚ûï T·∫°o K√®o m·ªõi
        </a>
    </div>

    <div class="row">
        @foreach (var challenge in Model.Challenges)
        {
            <div class="col-md-6 col-lg-4 mb-4">
                <div class="card h-100 shadow-sm border-@(challenge.Status == "Open" ? "success" : challenge.Status == "Closed" ? "warning" : "secondary") animate__animated card-hover-gradient challenge-card" tabindex="0">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-start mb-2">
                            <h5 class="card-title mb-0">@challenge.Title</h5>
                            <span class="badge @(challenge.Status == "Open" ? "bg-success" : challenge.Status == "Closed" ? "bg-warning text-dark" : "bg-secondary")">
                                @(challenge.Status == "Open" ? "ƒêang m·ªü" : challenge.Status == "Closed" ? "Ch·ªët r·ªìi" : "Ho√†n th√†nh")
                            </span>
                        </div>

                        <p class="text-muted small mb-2">
                            <strong>Ng∆∞·ªùi t·∫°o:</strong> @challenge.Creator.FullName
                        </p>

                        <div class="mb-3">
                            <p class="card-text">
                                <strong>Th·ªÉ th·ª©c:</strong> 
                                <span class="badge bg-info">@challenge.ModeDisplay</span>
                            </p>
                            <p class="card-text">
                                <strong>Ph·∫ßn th∆∞·ªüng:</strong> @challenge.RewardDescription
                            </p>
                        </div>

                        @if (challenge.Mode == 2) // Mini-game
                        {
                            <div class="alert alert-warning p-2 small mb-2">
                                üí∞ <strong>L·ªá ph√≠:</strong> @challenge.EntryFee.ToString("C0") / ng∆∞·ªùi<br/>
                                üèÜ <strong>Qu·ªπ th∆∞·ªüng hi·ªán t·∫°i:</strong> <strong class="text-success">@challenge.TotalPot.ToString("C0")</strong>
                            </div>
                        }

                        <p class="text-muted small mb-3">
                            üë• <strong>@challenge.Participants.Count</strong> ng∆∞·ªùi tham gia
                        </p>

                        <a asp-page="./Details" asp-route-id="@challenge.Id" class="btn btn-primary btn-sm w-100">
                            Xem chi ti·∫øt
                        </a>
                    </div>
                </div>
            </div>
        }
    </div>

    @if (Model.Challenges.Count == 0)
    {
        <div class="alert alert-info">Ch∆∞a c√≥ k√®o n√†o. H√£y t·∫°o k√®o ƒë·∫ßu ti√™n!</div>
    }
</div>
